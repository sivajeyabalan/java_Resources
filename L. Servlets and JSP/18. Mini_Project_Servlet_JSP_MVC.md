## 1. Topic Overview

Build a simple Product Catalog using MVC: list products, show details, and add a product using PRG.

## 2 . Topic definition

- **Scope**: Servlet controllers, JSP views with JSTL, session-safe flash messages, and basic validation.

## 3. Deep Dive with Examples

```java
// ProductListServlet.java
@WebServlet("/products")
public class ProductListServlet extends HttpServlet {
  private final ProductService service = new ProductService();
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    req.setAttribute("products", service.findAll());
    req.getRequestDispatcher("/WEB-INF/views/products.jsp").forward(req, resp);
  }
}
```

```java
// ProductAddServlet.java
@WebServlet("/products/add")
public class ProductAddServlet extends HttpServlet {
  private final ProductService service = new ProductService();
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    req.getRequestDispatcher("/WEB-INF/views/product_form.jsp").forward(req, resp);
  }
  protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws IOException {
    String name = req.getParameter("name");
    String priceStr = req.getParameter("price");
    java.util.List<String> errors = new java.util.ArrayList<>();
    if (name == null || name.isBlank()) errors.add("Name required");
    double price = 0;
    try { price = Double.parseDouble(priceStr); } catch (Exception e) { errors.add("Price invalid"); }
    if (!errors.isEmpty()) {
      req.getSession().setAttribute("flashErrors", errors);
      resp.sendRedirect(req.getContextPath()+"/products/add");
      return;
    }
    service.add(new Product(name, price));
    req.getSession().setAttribute("flashMsg", "Product added");
    resp.sendRedirect(req.getContextPath()+"/products");
  }
}
```

```jsp
<!-- /WEB-INF/views/products.jsp -->
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<h2>Products</h2>
<c:if test="${not empty sessionScope.flashMsg}"><div>${sessionScope.flashMsg}</div><c:remove var="flashMsg" scope="session"/></c:if>
<table border="1"><tr><th>Name</th><th>Price</th></tr>
<c:forEach var="p" items="${products}"><tr><td>${p.name}</td><td>${p.price}</td></tr></c:forEach>
</table>
<a href="${pageContext.request.contextPath}/products/add">Add</a>
```

```jsp
<!-- /WEB-INF/views/product_form.jsp -->
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<h2>Add Product</h2>
<c:if test="${not empty sessionScope.flashErrors}">
  <ul><c:forEach var="e" items="${sessionScope.flashErrors}"><li>${e}</li></c:forEach></ul>
  <c:remove var="flashErrors" scope="session"/>
</c:if>
<form method="post">
  Name: <input name="name"/>
  Price: <input name="price"/>
  <button>Save</button>
</form>
```

## 4. Best Practices & Pitfalls

- Use PRG for form submissions; keep JSP as view-only; sanitize inputs.
- Manage flash messages via session and remove after read.

## 5. Summary

- End-to-end MVC with list + add flow, validation, PRG, and clean views.

## 6. Tricky Interview Questions

1) Where to put validation to keep controllers thin and views clean?
2) How to persist data beyond app restarts without adding full ORM?
