## 1. Topic Overview

Web security spans authentication, authorization, session protection, CSRF, and XSS prevention. Even in classic Servlet/JSP apps, these controls are critical.

## 2 . Topic definition

- **Authentication**: Verifying user identity.
- **Authorization**: Enforcing permissions/roles.
- **CSRF**: Cross-site request forgery; attacker tricks browser to send a valid request.
- **XSS**: Injection of untrusted scripts into pages viewed by users.

## 3. Deep Dive with Examples

```xml
<!-- web.xml security constraints (basic example) -->
<security-constraint>
  <web-resource-collection>
    <web-resource-name>secure</web-resource-name>
    <url-pattern>/secure/*</url-pattern>
  </web-resource-collection>
  <auth-constraint>
    <role-name>USER</role-name>
  </auth-constraint>
</security-constraint>
<login-config>
  <auth-method>FORM</auth-method>
  <form-login-config>
    <form-login-page>/login.jsp</form-login-page>
    <form-error-page>/login.jsp?error=1</form-error-page>
  </form-login-config>
</login-config>
```

```jsp
<!-- CSRF token pattern -->
<% String token = java.util.UUID.randomUUID().toString(); session.setAttribute("CSRF", token); %>
<form method="post" action="/transfer">
  <input type="hidden" name="_csrf" value="<%= token %>"/>
</form>
```

```java
// Validate CSRF token
String token = req.getParameter("_csrf");
String expected = (String) req.getSession().getAttribute("CSRF");
if (expected == null || !expected.equals(token)) { resp.sendError(403); return; }
```

## 4. Best Practices & Pitfalls

- Encode untrusted output in JSP (`<c:out>` or EL auto-escaping in some stacks).
- Set `HttpOnly`, `Secure`, `SameSite` on session cookies; rotate on login.
- Use HTTPS everywhere; configure HSTS.
- Pitfall: Storing roles/permissions only on client; keep them server-side.

## 5. Summary

- Enforce authZ, protect sessions, mitigate CSRF/XSS with tokens and encoding.

## 6. Tricky Interview Questions

1) How to defend against reflected vs stored XSS on a JSP page?
2) What session fixation risks exist and how do you prevent them?
