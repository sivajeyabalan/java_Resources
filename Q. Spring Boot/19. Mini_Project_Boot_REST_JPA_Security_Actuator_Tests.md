## 1. Topic Overview

- Build a realistic Spring Boot REST service with JPA persistence, validation, security (JWT), Actuator, and tests (slices + Testcontainers).

## 2 . Topic definition

- WHAT: A modular mini-project showcasing best practices end-to-end.
- WHY: Consolidate core Boot interview topics in one runnable example.
- HOW: Define entity/repository/service/controller, add validation, secure with JWT resource server, expose Actuator, and write tests.
- WHEN/WHERE: Ideal for interviews and portfolio demos.

## 3. Deep Dive with Examples

Project structure (key parts):
- Domain: `Book{id, title, author}`
- Repository: `BookRepository extends JpaRepository<Book, Long>`
- Service: `BookService` with `@Transactional`
- Web: `BookController` with `@Validated` DTOs
- Security: Resource server with JWT
- Ops: Actuator with health/metrics
- Tests: `@WebMvcTest` + `@DataJpaTest` + Testcontainers

```java
// Entity
import jakarta.persistence.*;
import jakarta.validation.constraints.*;

@Entity
public class Book {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    @NotBlank private String title;
    @NotBlank private String author;
    // getters/setters
}
```

```java
// Repository
import org.springframework.data.jpa.repository.JpaRepository;
public interface BookRepository extends JpaRepository<Book, Long> {}
```

```java
// Service
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@Service
public class BookService {
    private final BookRepository repo;
    public BookService(BookRepository repo) { this.repo = repo; }

    @Transactional(readOnly = true)
    public java.util.List<Book> list() { return repo.findAll(); }

    @Transactional
    public Book create(Book b) { return repo.save(b); }
}
```

```java
// Controller
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/books")
public class BookController {
    private final BookService svc;
    public BookController(BookService svc) { this.svc = svc; }

    @GetMapping public java.util.List<Book> list() { return svc.list(); }
    @PostMapping public Book create(@RequestBody @jakarta.validation.Valid Book b) { return svc.create(b); }
}
```

```java
// Security config (JWT resource server)
import org.springframework.context.annotation.*;
import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

@Configuration @EnableMethodSecurity
class SecurityConfig {
    @Bean SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http.csrf(csrf -> csrf.disable())
            .authorizeHttpRequests(reg -> reg
                .requestMatchers("/actuator/health","/v3/api-docs/**","/swagger-ui/**").permitAll()
                .anyRequest().authenticated())
            .oauth2ResourceServer(oauth2 -> oauth2.jwt());
        return http.build();
    }
}
```

```properties
# application.properties
spring.datasource.url=jdbc:h2:mem:books;DB_CLOSE_DELAY=-1
spring.jpa.hibernate.ddl-auto=update
management.endpoints.web.exposure.include=health,info,metrics
```

```java
// Tests
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
// Add MockMvc tests for controller and @DataJpaTest for repository
```

## 4. Best Practices & Pitfalls

- Keep DTOs separate from entities for public APIs in real projects.
- Secure actuator; expose only needed endpoints.
- Prefer Testcontainers for persistent DB integration tests.

## 5. Summary

- This mini-project unifies REST, JPA, validation, security, actuator, and testsâ€”ideal for interview walkthroughs.

## 6. Tricky Interview Questions

1. How do you wire JWT validation for local testing without an IdP?
2. What transactional boundaries do you choose in service methods and why?

