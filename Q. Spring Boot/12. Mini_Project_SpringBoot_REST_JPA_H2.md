## 1. Topic Overview

Mini-project: Build a Spring Boot REST API for `Book` with CRUD, validation, and H2 persistence. Includes Initializr setup, JPA repo, and controller with error handling.

## 2 . Topic definition

- **Scope**: Boot app, entity, repository, service, controller, validation, H2 console.

## 3. Deep Dive with Examples

build.gradle:
```groovy
implementation 'org.springframework.boot:spring-boot-starter-web'
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
runtimeOnly 'com.h2database:h2'
```

application.yml:
```yaml
spring:
  datasource:
    url: jdbc:h2:mem:demo;DB_CLOSE_DELAY=-1
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
  h2:
    console:
      enabled: true
```

Entity + repository:
```java
@Entity class Book { @Id @GeneratedValue Long id; @NotBlank String title; @NotBlank String author; }
public interface BookRepo extends JpaRepository<Book, Long> {}
```

Service:
```java
@Service
class BookService { private final BookRepo repo; BookService(BookRepo r){this.repo=r;}
  List<Book> all(){ return repo.findAll(); }
  Book get(Long id){ return repo.findById(id).orElseThrow(() -> new EntityNotFoundException("Book")); }
  Book save(Book b){ return repo.save(b); }
  void delete(Long id){ repo.deleteById(id); }
}
```

Controller:
```java
@RestController @RequestMapping("/api/books")
class BookApi {
  private final BookService svc; BookApi(BookService s){ this.s=s; }
  @GetMapping List<Book> all(){ return svc.all(); }
  @GetMapping("/{id}") Book one(@PathVariable Long id){ return svc.get(id); }
  @PostMapping ResponseEntity<Book> create(@Valid @RequestBody Book b){ return ResponseEntity.status(HttpStatus.CREATED).body(svc.save(b)); }
  @PutMapping("/{id}") Book update(@PathVariable Long id, @Valid @RequestBody Book b){ b.id = id; return svc.save(b); }
  @DeleteMapping("/{id}") ResponseEntity<Void> delete(@PathVariable Long id){ svc.delete(id); return ResponseEntity.noContent().build(); }
}
```

Global errors:
```java
@ControllerAdvice class Errors { @ExceptionHandler(EntityNotFoundException.class) ResponseEntity<?> nf(EntityNotFoundException e){ return ResponseEntity.status(404).body(Map.of("error","NOT_FOUND")); } }
```

## 4. Best Practices & Pitfalls

- Validate DTOs; use 201/204 appropriately; handle not-found cleanly.
- Keep controller thin; put business rules in services; enable H2 console only in dev.

## 5. Summary

- End-to-end Boot REST with JPA/H2 demonstrating CRUD, validation, and global error handling.

## 6. Tricky Interview Questions

1) How to add pagination/sorting to list endpoint with Spring Data?
2) How to secure H2 console and expose only in non-prod profiles?
